# Домашняя работа

## Задание 1. Анализ и планирование

### 1. Описание функциональности монолитного приложения

**Управление отоплением:**

- Пользователь может включать и отключать отопление.
- Пользователь может регулировать отопление, через установку желаемой температуры.

**Мониторинг температуры:**

- Пользователь может просматривать текущую температуру через веб-интерфейс.

### 2. Анализ архитектуры монолитного приложения

- Технический аспект
  - Язык программирования: Java 17
  - Система сборки: Maven >=3.8.1 && <4.0.0
  - Библиотека логирования slf4j
  - База данных: PostgreSQL
  - Бэкенд.
    - Архитектура: монолит.
    - Взаимодействие с внешними приложениями: синхронное.
    - Масштабирование: невозможно, так как не настроен маршрутизатор позволяющий перенаправлять запросы от фронтенда.
    - Развертывание: для обновления требуется остановка монолита, так как нет маршрутизатора.
  - Фронтенд.
    - Передан на аутсорс.

### 3. Определение доменов и границы контекстов

- Текущее домены.
  - Домен мониторинга температуры.
  - Домен управления отоплением.
- Планируемые домены.
  - Домен управления пользователями.
  - Домен управления светом.
  - Домен управления воротами.
  - Домен управления камерами.

### 4. Проблемы монолитного решения

- Отсутствие масштабируемости. Любое обновление останавливает прод на неопределенное время.
- Низкая отказоустойчивость. При большой нагрузке вся система встанет, пользователь не сможет ни посмотреть температуру не отрегулировать отопление. Решается разделением монолита или ведением асинхронной обработки запросов в сам монолит.

### 5. Визуализация контекста системы — диаграмма С4

Данная диаграмма представляет из себя "as-is" описание текущего решения.

[Диаграмма систем](./docs/context_as_is.plantuml)

### Вывод по 1 заданию

- Во первых необходимо настроить маршрутизацию через API Gateway, чтобы обеспечить масштабируемость и повысить отказоустойчивость.
- Во вторых внедрить метрики для отслеживания нагрузки на куски кода связанные с конкретными доменами(Домен мониторинга температуры, Домен управления отоплением и т.д.). Чтобы при вынесении бизнес логики из монолита были объективные данные необходимости выделения конкретного домена в отдельный микросервис.
  - В рамках данной домашней работы я исхожу из предположения, что все домены необходимо выделить в отдельные микросервисы, так как предполагаемая нагрузка на сервис будет высокой.

## Задание 2. Проектирование микросервисной архитектуры

Диаграммы ниже представляют из себя "to-be" решения с учетом пожеланий компании.

- [Диаграмма систем](./docs/context_to_be.plantuml)
- [Диаграмма контейнера](./docs/container_to_be.plantuml)
- [Диаграмма компонентов](./docs/component_to_be.plantuml)
- [Диаграмма кода, компонент управления отоплением](./docs/code_heat_manager_to_be.plantuml)

